CREATE MATERIALIZED VIEW NrOfStudents AS SELECT CourseOffers.CourseOfferId, COUNT(CourseRegistrations.StudentRegistrationId) AS NrOfStudents FROM CourseOffers INNER JOIN CourseRegistrations on (CourseOffers.CourseOfferId = CourseRegistrations.CourseOfferId) GROUP BY CourseOffers.CourseOfferId;
CREATE MATERIALIZED VIEW NrOfAssistants AS SELECT CourseOffers.CourseOfferId, COUNT(StudentAssistants.StudentRegistrationId) AS NrOfAssistants FROM CourseOffers INNER JOIN StudentAssistants on (CourseOffers.CourseOfferId = StudentAssistants.CourseOfferId) GROUP BY CourseOffers.CourseOfferId;